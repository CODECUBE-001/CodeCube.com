curl(["js!"+z.moo],function(){function t(){var t=n().hash.replace("#",m),e=$$("#"+t+", a[name="+t+"]");return t&&e[f]?e[0]:0}function e(t){var e=n();return t.replace(e.protocol+"//"+e.host,m)}function n(){return i.location}function s(t,e){i.location=t}function a(t,e,n){var s;return function(){var a=this,i=arguments;clearTimeout(s),s=setTimeout(function(){s=null,n||t.apply(a,i)},e),n&&!s&&t.apply(a,i)}}var i=z.w,o=z.d,r=$(o.body),c=$("main"),l="/page/loaded",u="/sidebar/loaded",h="click",d="value",f="length",m="",p=function(){};z.isDebug&&sessionStorage.clear();var v=function(){var t;return function(){return t||(t=new Element("div",{"class":"device-state offscreen"}).inject(r)),parseInt(t.getStyle("z-index"),10)}}(),g={reloadAll:function(){try{this.reloadBSA()}catch(e){console.log("BSA errored")}},reloadSidebar:function(){try{this.reloadBSA()}catch(e){console.log("BSA errored")}},reloadBSA:function(){curl(["js!https://s3.buysellads.com/ac/bsa.js"],function(){$$("script[id^=_bsap_js_]").destroy(),$$(".bsa").each(function(t){var e=t.get("data-bsa");if(e){var n=e.split("|");t.innerHTML='<div id="bsap_'+n[0]+'" class="bsarocks bsap_'+n[1]+'"></div>'}}),i._bsap&&_bsap.exec()})}},b=function(){var t={},e=t.hasOwnProperty;return{subscribe:function(n,s,a){e.call(t,n)||(t[n]=[]);var i=t[n].push(s)-1;return a&&s({}),{remove:function(){delete t[n][i]}}},publish:function(n,s){e.call(t,n)&&t[n].each(function(t){t(s||{})})}}}();Class.Binds=new Class({$bound:{},bound:function(t){return this.$bound[t]?this.$bound[t]:this.$bound[t]=this[t].bind(this)}}),Request.JSONP=new Class({Implements:[Chain,Events,Options],options:{onRequest:function(t){this.options.log&&winconsole&&console.log},onError:function(t){this.options.log&&winconsole&&console.warn},url:m,callbackKey:"callback",injectScript:o.head,data:m,link:"ignore",timeout:0,log:!1},initialize:function(t){this.setOptions(t)},send:function(t){if(!Request.prototype.check.call(this,t))return this;this.running=!0;var e=typeOf(t);("string"==e||"element"==e)&&(t={data:t}),t=Object.merge(this.options,t||{});var n=t.data;switch(typeOf(n)){case"element":n=$(n).toQueryString();break;case"object":case"hash":n=Object.toQueryString(n)}var s=this.index=Request.JSONP.counter++,a=t.url+(t.url.test("\\?")?"&":"?")+t.callbackKey+"=Request.JSONP.request_map.request_"+s+(n?"&"+n:m);a[f]>2083&&this.fireEvent("error",a),Request.JSONP.request_map["request_"+s]=function(){this.success(arguments,s)}.bind(this);var i=this.getScript(a).inject(t.injectScript);return this.fireEvent("request",[a,i]),t.timeout&&this.timeout.delay(t.timeout,this),this},getScript:function(t){return this.script||(this.script=new Element("script",{type:"text/javascript",async:!0,src:t})),this.script},success:function(t,e){this.running&&this.clear().fireEvent("complete",t).fireEvent("success",t).callChain()},cancel:function(){return this.running&&this.clear().fireEvent("cancel"),this},isRunning:function(){return!!this.running},clear:function(){return this.running=!1,this.script&&(this.script.destroy(),this.script=null),this},timeout:function(){return this.running&&(this.running=!1,this.fireEvent("timeout",[this.script.get("src"),this.script]).fireEvent("failure").cancel()),this}}),Request.JSONP.counter=0,Request.JSONP.request_map={},function(){function t(t){return/^(?:body|html)$/i.test(t.tagName)}Fx.Scroll=new Class({Extends:Fx,options:{offset:{x:0,y:0},wheelStops:!0},initialize:function(t,e){var n,s;this.element=this.subject=$(t),this.parent(e),"element"!=typeOf(this.element)&&(this.element=$(this.element.getDocument().body)),this.options.wheelStops&&(n=this.element,s=this.cancel.pass(!1,this),this.addEvent("start",function(){n.addEvent("mousewheel",s)},!0),this.addEvent("complete",function(){n.removeEvent("mousewheel",s)},!0))},set:function(){var t=Array.flatten(arguments);return Browser.firefox&&(t=[Math.round(t[0]),Math.round(t[1])]),this.element.scrollTo(t[0],t[1]),this},compute:function(t,e,n){return[0,1].map(function(s){return Fx.compute(t[s],e[s],n)})},start:function(t,e){var n;return this.check(t,e)?(n=this.element.getScroll(),this.parent([n.x,n.y],[t,e])):this},calculateScroll:function(t,e){var n,s=this.element,a=s.getScrollSize(),i=s.getScroll(),o=s.getSize(),r=this.options.offset,c={x:t,y:e};for(n in c)!c[n]&&0!==c[n]&&(c[n]=i[n]),"number"!=typeOf(c[n])&&(c[n]=a[n]-o[n]),c[n]+=r[n];return[c.x,c.y]},toTop:function(){return this.start.apply(this,this.calculateScroll(!1,0))},toLeft:function(){return this.start.apply(this,this.calculateScroll(0,!1))},toRight:function(){return this.start.apply(this,this.calculateScroll("right",!1))},toBottom:function(){return this.start.apply(this,this.calculateScroll(!1,"bottom"))},toElement:function(e,n){var s,a;return n=n?Array.from(n):["x","y"],s=t(this.element)?{x:0,y:0}:this.element.getScroll(),a=Object.map($(e).getPosition(this.element),function(t,e){return n.contains(e)?t+s[e]:!1}),this.start.apply(this,this.calculateScroll(a.x,a.y))},toElementEdge:function(t,e,n){var s,a,i,o,r,c;return e=e?Array.from(e):["x","y"],t=$(t),s={},a=t.getPosition(this.element),i=t.getSize(),o=this.element.getScroll(),r=this.element.getSize(),c={x:a.x+i.x,y:a.y+i.y},["x","y"].each(function(t){e.contains(t)&&(c[t]>o[t]+r[t]&&(s[t]=c[t]-r[t]),a[t]<o[t]&&(s[t]=a[t])),null==s[t]&&(s[t]=o[t]),n&&n[t]&&(s[t]=s[t]+n[t])},this),(s.x!=o.x||s.y!=o.y)&&this.start(s.x,s.y),this},toElementCenter:function(t,e,n){var s,a,i,o,r;return e=e?Array.from(e):["x","y"],t=$(t),s={},a=t.getPosition(this.element),i=t.getSize(),o=this.element.getScroll(),r=this.element.getSize(),["x","y"].each(function(t){e.contains(t)&&(s[t]=a[t]-(r[t]-i[t])/2),null==s[t]&&(s[t]=o[t]),n&&n[t]&&(s[t]=s[t]+n[t])},this),(s.x!=o.x||s.y!=o.y)&&this.start(s.x,s.y),this}})}();var y=function(t){return function(e){t.toElement(e)}}(new Fx.Scroll(i,{onComplete:function(){b.publish("/scroll/complete")}})),E={set:function(t,e){try{sessionStorage.setItem(t,e)}catch(n){}},get:function(t){try{return sessionStorage.getItem(t)}catch(e){}return null}};!function(){function t(t){return t.preventDefault(),t.type==h&&o.hasClass(l)?void e(m):(s&&clearTimeout(s),a=setTimeout(function(){n(c[0]),o.addClass(l),u.removeClass(d).addClass(f)},t.type==h?0:m),!1)}function e(t){a&&clearTimeout(a),s=setTimeout(function(){o.removeClass(l),u.removeClass(f).addClass(d)},t)}function n(t){o.getElements("."+l).removeClass(l),t.addClass(l),$("nav-"+t.get(r)).addClass(l)}var s,a,i=$$(".logo")[0],o=$("main-nav"),r="data-content",c=o.getElements("a["+r+"]"),l="active",u=$("logo-icon"),d=u.get("class").split(" ")[1],f=u.get("data-open-icon"),m=200;i.addEvents({mouseenter:t,click:t}),c.each(function(t){t.addEvent("mouseenter",function(){n(t)})}),o.addEvent("mouseenter",function(){s&&clearTimeout(s)}),$$(o,i).addEvent("mouseleave",function(){e(m)}).addEvent(h+":relay(a)",function(){a&&clearTimeout(a),o.removeClass(l)})}(),z.loadSidebar&&function(){function t(t){var e=new Element("div",{"class":"sidebar",html:t});c.parentNode.appendChild(e),e.fade(1)}var e="sidebar",n=E.get(e+"-punky"),s=function(){setTimeout(function(){g.reloadSidebar()},1e3)};n?(t(n),b.publish(u),s()):curl(["text!"+z.themePath+"/"+e+".php"],function(n){E.set(e+"-punky",n),t(n),b.publish(u),s()})}();var C=function(){return{trackPageView:function(){i.ga&&ga("send","pageview",location+m)},trackEvent:function(t,e){var n={hitType:"event",eventCategory:t.category||m,eventAction:t.action||m,eventLabel:t.label||m,eventValue:t.value||0,hitCallback:e||p};i.ga?ga("send",n):e&&e()}}}();z.analyticsID&&b.subscribe(l,function(){C.trackPageView()}),location.search&&C.trackEvent({category:"Search",label:location.search.replace("?s=",m)}),curl(["js!libs/prism.js"],function(){function t(t){$$(t||"pre, .comments code").each(function(t){if(!(t.get("prism")||t.hasClass("codepen")||t.getParent(".gist"))){var e=t.get("html");if("code"==t.get("tag")){if(-1==e.indexOf("\n"))return;t=new Element("pre").replaces(t),e=e.replace(/<br( \/)?>/g,"")}e=e.replace(/>/g,"&gt;").replace(/</g,"&lt;").trim();var n=t.className||"js",s="language-"+n.toLowerCase();t.set({html:'<code class="'+s+'">'+e+"</code>",prism:1,"class":s}),Prism.highlightElement(t)}})}var e=Prism.languages;e.xml=e.html=e.markup,e.json=e.js=e.javascript,e.shell=e.bash,e.sass=e.stylus=e.scss=e.css,b.subscribe(l,function(){t()},!0),b.subscribe("/comments/placed",function(e){t(e.element.getElements("pre, code"))})}),function(){function t(t,e,s){var a=e+s,i=function(e){t.get(n)||e&&"undefined"!=e&&"0"!=e&&new Element("span",{html:e}).inject(t.parentNode)&&t.set(n,1)},o=E.get(a);null!=o?i(o):new Request.JSONP({url:e,callback:"callback",timeout:5e3,onComplete:function(t){var e=t[s];i(e),E.set(a,e)}}).send()}function e(){var e=$$(".meta .get-count");e[f]&&e.each(function(e){{var n=e.getParent("ul"),s=n.get("data-url").replace(location.host,z.domain);n.get("data-title")}e.hasClass("twitter")||e.hasClass("facebook")&&t(e,"https://graph.facebook.com/?id="+s,"shares")})}var n="data-counted";r.addEvent(h+":relay(.social-icons a.soc)",function(t,e){t.stop();var n=e.getParent("ul"),s=encodeURIComponent(n.get("data-url")),a=n.get("data-title"),i=n.get("data-twitter-handle")||"davidwalshblog";e.hasClass("twitter")?open("http://twitter.com/share?url="+s+"&text="+a+" by @"+i,"tshare","height=400,width=550,resizable=1,toolbar=0,menubar=0,status=0,location=0"):e.hasClass("facebook")?open("http://facebook.com/sharer.php?s=100&p[url]="+s+"&p[images][0]="+z.themePath+"/images/open-graph.png&p[title]="+a,"fbshare","height=380,width=660,resizable=0,toolbar=0,menubar=0,status=0,location=0,scrollbars=0"):e.hasClass("google-plus")&&open("https://plus.google.com/share?url="+s,"gshare","height=270,width=630,resizable=0,toolbar=0,menubar=0,status=0,location=0,scrollbars=0")}),v()<=2&&function(){b.subscribe(l,function(){e()},!0)}()}(),b.subscribe(l,function(){var t=function(){i.CodePenEmbed&&CodePenEmbed.init()};$$(".codepen")[f]&&function(){if(i.CodePenEmbed)return t();var e=o.createElement("script");e.onload=t,e.async=!0,e.src="//codepen.io/assets/embed/ei.js",r.appendChild(e)}()},!0),b.subscribe(l,function(){$$(".twitter-tweet")[f]&&curl(["js!//platform.twitter.com/widgets.js"],function(){i.twttr&&twttr.widgets.load()})},!0),function(t){t.addEvent(h+":relay(.post-list > li)",function(t,e){var n=$(t.target);if("a"!=n.get("tag")&&!n.getParents("a")[f]){var a=e.get("data-url");if(t.meta||t.control)return t.preventDefault(),i.open(a),!1;History.push&&a.indexOf(location.hostname)>-1?(History.push(a),C.trackEvent({category:"Post List Click: "+a,action:a})):(s(a,"post-items"),C.trackEvent({category:"Post List Click _else_",action:a}))}})}(c),function(){var t=function(){var t="data-src";$$("img["+t+"]").each(function(e){e.addEvent("load",function(){e.removeAttribute(t)}),e.set("src",e.get(t))})};b.subscribe(l,t,!0),b.subscribe(u,t,!0)}(),function(){function t(t){$("comment-form").inject(t)}function e(e){var n=e.get("id").replace("comment-",m),s=$("comment");v()<=2&&new Element("img",{src:e.get("data-avatar"),alt:""}).inject(e,"top"),new Element("a",{html:'<i aria-hidden="true" class="fa fa-reply"></i>',href:"javascript:;",events:{click:function(){$("comment_parent").set(d,n),t(e),s.focus()}}}).inject(e.getElement(".comment-controls")),e.getElements("div[data-gist]").each(function(t){new Request.JSONP({url:t.get("data-gist")+".json",callback:"callback",timeout:5e3,onComplete:function(e){t.set("html",e.div),curl(["css!"+e.stylesheet])}}).send()}),e.getElements("div[data-fiddle]").each(function(t){new IFrame({src:t.get("data-fiddle").replace("http:","https:")}).inject(t)})}var n;b.subscribe(l,function(){var t=$("comment-list");t&&t.addClass("avatars").getElements("li[data-avatar]").each(e)},!0),c.addEvent(h+":relay(#launch-editor)",function(){var t=($("launch-editor"),$("comment"));this.addClass("hidden");var e="libs/ace/",s=t;curl(["js!"+e+"consolidated.js"],function(){var t=new Element("div",{id:"ace-box"}).inject(s,"after");s.addClass("hidden");var e=n=ace.edit(t);e.setTheme("ace/theme/dreamweaver");var a=this.aceSession=e.getSession();a.setMode(new require("ace/mode/javascript").Mode()),a.setValue(s.get(d)),a.on("change",function(){s.set(d,e.getSession().getValue())}),setTimeout(function(){e.focus()},1e3)}),C.trackEvent({category:"Comments",action:"ACE code editor requested"})}),c.addEvent("submit:relay(#cForm)",function(t){t.preventDefault();var s=$("cForm");s.disabled||new Request({url:s.action,method:"post",onRequest:function(){s.disabled=!0},onSuccess:function(t){if("0"!=t){var a=$("comment_parent"),i=$("comment-list");if(a.get(d)){var o=s.getParent("li"),r=$(o.parentNode);if(r.hasClass("children"))r.insertAdjacentHTML("beforeend",t),i=r;else{var c=new Element("ul",{"class":"children"}).inject(o);c.insertAdjacentHTML("beforeend",t),i=c}}else i.insertAdjacentHTML("beforeend",t);var l=i.lastChild;e(l),b.publish("/comments/placed",{element:l}),$("comment").set(d,m),a.set(d,m),n&&n.setValue(m),$(s.parentNode).inject($("comment-form-holder")),y(l)}},onComplete:function(){s.disabled=!1}}).send(s.toQueryString()+"&legit=1")})}(),function(){var t=Element.NativeEvents,e=window.location,n=function(t){return t&&t.match(/^https?:\/\//)&&(t="/"+t.split("/").slice(3).join("/")),t},s=n(e.href),a=window.history,i="pushState"in a,o=i?"popstate":"hashchange";this.History=new new Class({Implements:[Class.Binds,Events],initialize:i?function(){t[o]=2,window.addEvent(o,this.bound("pop"))}:function(){t[o]=1,window.addEvent(o,this.bound("pop")),this.hash=e.hash;var n="onhashchange"in window;n&&(void 0===document.documentMode||document.documentMode>7)||(this.timer=this.check.periodical(200,this))},cleanURL:n,push:i?function(t,e,i){t=n(t),s&&s!=t&&(s=null),a.pushState(i||null,e||null,t),this.onChange(t,i)}:function(t){e.hash=n(t)},replace:i?function(t,e,s){a.replaceState(s||null,e||null,n(t))}:function(t){t=n(t),this.hash="#"+t,this.push(t)},pop:i?function(t){var a=n(e.href);return a==s?void(s=null):void this.onChange(a,t.event.state)}:function(){var t=e.hash;this.hash!=t&&(this.hash=t,this.onChange(n(t.substr(1))))},onChange:function(t,e){this.fireEvent("change",[t,e||{}])},back:function(){a.back()},forward:function(){a.forward()},getPath:function(){return n(i?e.href:e.hash.substr(1))},hasPushState:function(){return i},check:function(){this.hash!=e.hash&&this.pop()}})}.call(this),curl([],function(){function s(){r.addClass(S)}function a(){r.removeClass(S)}function u(e){r.hasClass("demo")&&d();var n=p(e);r.className=n.classes,c.set("html",n.postContent),z.d.title=n.title,$$("link[rel=canonical]").set("href",n.canonical),$$("#masthead-title-text").set("html",n.heading),b.publish(l),y(t()||$("top"))}function d(t){return $$(".demo-iframe").setStyle("display","none").destroy(),void 0!=g&&t&&setTimeout(function(){i.scrollTo(0,g);try{v&&v.focus()}catch(t){}},50),r.removeClass("demo"),!1}function p(t){var s="CONTENT",a="MASTHEAD",i=t.match(/<title>(.*)<\/title>/)[1],o={postContent:t.substring(t.indexOf("<!--"+s+"-->"),t.indexOf("<!--/"+s+"-->")),title:i,heading:(t.substring(t.indexOf("<!--"+a+"-->"),t.indexOf("<!--/"+a+"-->"))||i).replace(/\s(?=[^\s]*$)/g,"&nbsp;")},r=t.match(/body class="([^"]*)"/);o.classes=r&&r[1]?r[1]:m;var c=t.match(/<link rel="canonical" href="(.*)"/),l=n()+m;return o.canonical=c&&c[f]>1?c[1]:l,w[e(l)]=t,o}var v,g,E,w={},S="loading";c.addEvent("click:relay(.demo-closer)",function(t){t.preventDefault()}),p(o.documentElement.innerHTML),r.addEvent(h+":relay(a:not([href=#],[href=javascript:;],[data-noxhr]))",function(t,e){if(v=t.target,g=i.scrollY,!t.meta&&!t.control&&2!=t.event.which&&-1!=e.href.indexOf(location.hostname)){var s=e.href,a=n(),o=a+m;-1==s.indexOf(a.host)||s.split("#")[0]==o.split("#")[0]||e.get("target")||(t.stop(),(-1!==s.indexOf("/http")||-1!==s.indexOf('"'))&&C.trackEvent({category:"Suspicious History.push URL",action:s,label:e.outerHTML}),History.push(s))}});var x,E,j=new Request({method:"get",timeout:1e4,link:"cancel",onRequest:s,onSuccess:u,onFailure:function(){C.trackEvent({category:"AJAX Page Load Failure",action:this.url,label:location+m})},onComplete:a});History.addEvent("change",function(i){j.cancel();var o=t();if(z.d.body.hasClass("demo")||!o){i=function(){var t=n();return-1==i.indexOf("http")&&(i=t.protocol+"//"+t.host+i),i}();var c=i.split(".").pop();if(-1==i.indexOf("/demo/")||"php"!==c&&"html"!==c)w[e(i)]?(s(),a(),u(w[e(i)])):(j.url=i,j.send());else{if(!x){var l="$$('.demo-iframe').setStyle('display', 'none').destroy();History.back();return false;";x=new Element("div",{"class":"demo-box",html:'<div class="demo-toolbar">                   <span class="intro">Demo for:                     <a href="javascript:;" class="demo-closer" id="demo-title"></a>                   </span>                   <a href="javascript:;" class="green-button demo-closer close data-noxhr" on'+h+'="'+l+'">Close Demo<i class="fa fa-times"></i></a>                 </div><div class="demo-iframe-holder"></div>'}).inject(r)}E=new IFrame({src:i,frameborder:0,"class":"demo-iframe",events:{load:function(){try{E.contentWindow.document.documentElement.className="demo-frame"}catch(t){}}}}).inject(x.getFirst(".demo-iframe-holder")),linkEl=x.getElements(".intro a")[0],E.addClass("fadeIn"),E.src=i+"?";var d=$$("a[href="+i+"]"),m=$$("h1, h2")[0].innerHTML;if(d[f]){var p=d[0].getParent("li");p&&(m=p.getFirst("h2 a").innerHTML)}linkEl.set("html",m),r.addClass("demo")}}})}),function(){var t="fixed",e=a(function(e){var n=i.scrollY,s=r.hasClass(t),a=$("single-social");n>200?s||(r.addClass(t),a.inject($("masthead-title-text"),"before")):s&&(r.removeClass(t),$("meta").appendChild(a))},10);b.subscribe(l,function(){i[(r.hasClass("single")?"add":"remove")+"Event"]("scroll",e)},!0),b.subscribe(l,function(){$$("#masthead-title .social-icons").destroy()})}(),b.subscribe(l,function(){g.reloadAll(1)}),function(){function t(){var t=$$(".x-secondary");if(t){var e=$$("article");if(e[f]){var n=$(e[0]).getFirst("> p");n&&t.inject(n,"after")}}}b.subscribe(l,function(){t()}),t()}()});
